



<!DOCTYPE html>
<html lang="zh" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      <meta http-equiv="x-ua-compatible" content="ie=edge">
      
      
      
      
        <meta name="lang:clipboard.copy" content="复制">
      
        <meta name="lang:clipboard.copied" content="已复制">
      
        <meta name="lang:search.language" content="jp">
      
        <meta name="lang:search.pipeline.stopwords" content="True">
      
        <meta name="lang:search.pipeline.trimmer" content="True">
      
        <meta name="lang:search.result.none" content="没有找到符合条件的结果">
      
        <meta name="lang:search.result.one" content="找到 1 个符合条件的结果">
      
        <meta name="lang:search.result.other" content="# 个符合条件的结果">
      
        <meta name="lang:search.tokenizer" content="[\uff0c\u3002]+">
      
      <link rel="shortcut icon" href="https://cdn.jsdelivr.net/npm/oicdn@0.0.1/favicon.ico">
      <meta name="generator" content="mkdocs-1.0.4, mkdocs-material-3.0.6">
    
    
      
        <title>PDUR - My Wiki</title>
      
    
    
      <link rel="stylesheet" href="../../assets/stylesheets/application.451f80e5.css">
      
        <link rel="stylesheet" href="../../assets/stylesheets/application-palette.22915126.css">
      
      
        
        
        <meta name="theme-color" content="">
      
    
    
      <script src="../../assets/javascripts/modernizr.1aa3b519.js"></script>
    
    
      
        <link href="https://fonts.gstatic.com" rel="preconnect" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Fira+Sans:300,400,400i,700|Fira+Mono">
        <style>body,input{font-family:"Fira Sans","Helvetica Neue",Helvetica,Arial,sans-serif}code,kbd,pre{font-family:"Fira Mono","Courier New",Courier,monospace}</style>
      
    
    <link rel="stylesheet" href="../../assets/fonts/material-icons.css">
    
      <link rel="stylesheet" href="../../_static/css/extra.css?v=13">
    
    
  </head>
  
    
    
    <body dir="ltr" data-md-color-primary="white" data-md-color-accent="red">
  
    <svg class="md-svg">
      <defs>
        
        
      </defs>
    </svg>
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" data-md-component="overlay" for="__drawer"></label>
    
      <a href="#_1" tabindex="1" class="md-skip">
        跳转至
      </a>
    
    
      <header class="md-header" data-md-component="header">
  <nav class="md-header-nav md-grid">
    <div class="md-flex">
      <div class="md-flex__cell md-flex__cell--shrink">
        <a href="../.." title="My Wiki" class="md-header-nav__button md-logo">
          
            <i class="md-icon">school</i>
          
        </a>
      </div>
      <div class="md-flex__cell md-flex__cell--shrink">
        <label class="md-icon md-icon--menu md-header-nav__button" for="__drawer"></label>
      </div>
      <div class="md-flex__cell md-flex__cell--stretch">
        <div class="md-flex__ellipsis md-header-nav__title" data-md-component="title">
          
            
              <span class="md-header-nav__topic">
                My Wiki
              </span>
              <span class="md-header-nav__topic">
                PDUR
              </span>
            
          
        </div>
      </div>
      <div class="md-flex__cell md-flex__cell--shrink">
        
          
            <label class="md-icon md-icon--search md-header-nav__button" for="__search"></label>
            
<div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" placeholder="搜索" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="query" data-md-state="active">
      <label class="md-icon md-search__icon" for="__search"></label>
      <button type="reset" class="md-icon md-search__icon" data-md-component="reset" tabindex="-1">
        &#xE5CD;
      </button>
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" data-md-scrollfix>
        <div class="md-search-result" data-md-component="result">
          <div class="md-search-result__meta">
            键入以开始搜索
          </div>
          <ol class="md-search-result__list"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
          
        
      </div>
      
    </div>
  </nav>
</header>
    
    <div class="md-container">
      
        
      
      
        

  

<nav class="md-tabs md-tabs--active" data-md-component="tabs">
  <div class="md-tabs__inner md-grid">
    <ul class="md-tabs__list">
      
        
  
  
    <li class="md-tabs__item">
      
        <a href="../.." title="简介" class="md-tabs__link">
          简介
        </a>
      
    </li>
  

      
        
  
  
    <li class="md-tabs__item">
      
        <a href="./" title="网络" class="md-tabs__link md-tabs__link--active">
          网络
        </a>
      
    </li>
  

      
        
  
  
    <li class="md-tabs__item">
      
        <a href="../../NVM/nvm/" title="存储" class="md-tabs__link">
          存储
        </a>
      
    </li>
  

      
        
  
  
    <li class="md-tabs__item">
      
        <a href="../../ETH/Multicast/" title="以太网" class="md-tabs__link">
          以太网
        </a>
      
    </li>
  

      
        
  
  
    <li class="md-tabs__item">
      
        <a href="../../BASE/link_file/" title="基础模块" class="md-tabs__link">
          基础模块
        </a>
      
    </li>
  

      
        
  
  
    <li class="md-tabs__item">
      
        <a href="../../ERROR/ecc_error/" title="错误总结" class="md-tabs__link">
          错误总结
        </a>
      
    </li>
  

      
    </ul>
  </div>
</nav>
      
      <main class="md-main">
        <div class="md-main__inner md-grid" data-md-component="container">
          
            
              <div class="md-sidebar md-sidebar--primary" data-md-component="navigation">
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    <nav class="md-nav md-nav--primary" data-md-level="0">
  <label class="md-nav__title md-nav__title--site" for="__drawer">
    <a href="../.." title="My Wiki" class="md-nav__button md-logo">
      
        <i class="md-icon">school</i>
      
    </a>
    My Wiki
  </label>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
      


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-1" type="checkbox" id="nav-1">
    
    <label class="md-nav__link" for="nav-1">
      简介
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="1">
      <label class="md-nav__title" for="nav-1">
        简介
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../.." title="Getting Started" class="md-nav__link">
      Getting Started
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      

  


  <li class="md-nav__item md-nav__item--active md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-2" type="checkbox" id="nav-2" checked>
    
    <label class="md-nav__link" for="nav-2">
      网络
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="1">
      <label class="md-nav__title" for="nav-2">
        网络
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          

  


  <li class="md-nav__item md-nav__item--active">
    
    <input class="md-toggle md-nav__toggle" data-md-toggle="toc" type="checkbox" id="__toc">
    
    
      <label class="md-nav__link md-nav__link--active" for="__toc">
        PDUR
      </label>
    
    <a href="./" title="PDUR" class="md-nav__link md-nav__link--active">
      PDUR
    </a>
    
      
<nav class="md-nav md-nav--secondary">
  
  
  
    <label class="md-nav__title" for="__toc">目录</label>
    <ul class="md-nav__list" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#_1" title="介绍和功能总览" class="md-nav__link">
    介绍和功能总览
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#autosar" title="AutoSar架构" class="md-nav__link">
    AutoSar架构
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pdur" title="PDUR模块功能总览" class="md-nav__link">
    PDUR模块功能总览
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#i-pdu" title="I-PDU处理" class="md-nav__link">
    I-PDU处理
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#_2" title="缩略语" class="md-nav__link">
    缩略语
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#_3" title="约束和假设" class="md-nav__link">
    约束和假设
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#_4" title="限制条件" class="md-nav__link">
    限制条件
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#_5" title="已支持功能的限制条件" class="md-nav__link">
    已支持功能的限制条件
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#7" title="7 功能描述" class="md-nav__link">
    7 功能描述
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#71-i-pdu" title="7.1 I-PDU处理" class="md-nav__link">
    7.1 I-PDU处理
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#711-i-pdu" title="7.1.1 接收I-PDU给上层模块" class="md-nav__link">
    7.1.1 接收I-PDU给上层模块
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#7111" title="7.1.1.1 通信接口" class="md-nav__link">
    7.1.1.1 通信接口
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#7112" title="7.1.1.2 传输协议" class="md-nav__link">
    7.1.1.2 传输协议
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#71121-i-pdu" title="7.1.1.2.1 处理未知长度的I-PDU" class="md-nav__link">
    7.1.1.2.1 处理未知长度的I-PDU
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#712-i-pdu" title="7.1.2 从上层模块发送I-PDU" class="md-nav__link">
    7.1.2 从上层模块发送I-PDU
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#7121" title="7.1.2.1 多播" class="md-nav__link">
    7.1.2.1 多播
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#7122" title="7.1.2.2 通信接口" class="md-nav__link">
    7.1.2.2 通信接口
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#71221-trigger-transmit-data-provision" title="7.1.2.2.1 Trigger transmit data provision" class="md-nav__link">
    7.1.2.2.1 Trigger transmit data provision
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#71222" title="7.1.2.2.2 错误处理" class="md-nav__link">
    7.1.2.2.2 错误处理
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#7123" title="7.1.2.3 传输协议" class="md-nav__link">
    7.1.2.3 传输协议
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#71231" title="7.1.2.3.1 多播发送" class="md-nav__link">
    7.1.2.3.1 多播发送
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#71232" title="7.1.2.3.2 错误处理" class="md-nav__link">
    7.1.2.3.2 错误处理
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#71233-i-pdu" title="7.1.2.3.3 处理未知长度的I-PDU" class="md-nav__link">
    7.1.2.3.3 处理未知长度的I-PDU
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#713-i-pdu" title="7.1.3 I-PDU网关" class="md-nav__link">
    7.1.3 I-PDU网关
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#7131" title="7.1.3.1 通信接口模块" class="md-nav__link">
    7.1.3.1 通信接口模块
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#71311" title="7.1.3.1.1 错误处理" class="md-nav__link">
    7.1.3.1.1 错误处理
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#7132" title="7.1.3.2 传输协议" class="md-nav__link">
    7.1.3.2 传输协议
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#71321" title="7.1.3.2.1 缓冲区分配" class="md-nav__link">
    7.1.3.2.1 缓冲区分配
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#71322" title="7.1.3.2.2 直接网关" class="md-nav__link">
    7.1.3.2.2 直接网关
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#71323" title="7.1.3.2.3 转发给上层模块" class="md-nav__link">
    7.1.3.2.3 转发给上层模块
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#71324-gatewaying-on-the-fly" title="7.1.3.2.4 Gatewaying on-the-fly" class="md-nav__link">
    7.1.3.2.4 Gatewaying on-the-fly
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#71325" title="7.1.3.2.5 共同要求" class="md-nav__link">
    7.1.3.2.5 共同要求
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#71326" title="7.1.3.2.6 错误处理" class="md-nav__link">
    7.1.3.2.6 错误处理
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#71327-i-pdu" title="7.1.3.2.7 处理未知长度的I-PDU" class="md-nav__link">
    7.1.3.2.7 处理未知长度的I-PDU
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#7133-fifo" title="7.1.3.3 FIFO" class="md-nav__link">
    7.1.3.3 FIFO
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#71331" title="7.1.3.3.1 通信接口" class="md-nav__link">
    7.1.3.3.1 通信接口
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#71332" title="7.1.3.3.2 传输协议" class="md-nav__link">
    7.1.3.3.2 传输协议
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#71333" title="7.1.3.3.3 错误处理" class="md-nav__link">
    7.1.3.3.3 错误处理
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#72" title="7.2 取消发送" class="md-nav__link">
    7.2 取消发送
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#73" title="7.3 取消接收" class="md-nav__link">
    7.3 取消接收
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#74-zero-cost-operation" title="7.4 Zero Cost Operation" class="md-nav__link">
    7.4 Zero Cost Operation
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#75" title="7.5 状态管理" class="md-nav__link">
    7.5 状态管理
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#76-routing-path-groups" title="7.6 Routing path groups" class="md-nav__link">
    7.6 Routing path groups
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#77-complex-driver-interaction" title="7.7 Complex Driver Interaction" class="md-nav__link">
    7.7 Complex Driver Interaction
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
      
      
      
      
        <li class="md-nav__item">
          <a href="#__comments" title="评论" class="md-nav__link md-nav__link--active">
            评论
          </a>
        </li>
      
    </ul>
  
</nav>
    
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-3" type="checkbox" id="nav-3">
    
    <label class="md-nav__link" for="nav-3">
      存储
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="1">
      <label class="md-nav__title" for="nav-3">
        存储
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../NVM/nvm/" title="NVM" class="md-nav__link">
      NVM
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-4" type="checkbox" id="nav-4">
    
    <label class="md-nav__link" for="nav-4">
      以太网
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="1">
      <label class="md-nav__title" for="nav-4">
        以太网
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../ETH/Multicast/" title="组播" class="md-nav__link">
      组播
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../ETH/EthISR/" title="ENET-ISR" class="md-nav__link">
      ENET-ISR
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-5" type="checkbox" id="nav-5">
    
    <label class="md-nav__link" for="nav-5">
      基础模块
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="1">
      <label class="md-nav__title" for="nav-5">
        基础模块
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../BASE/link_file/" title="链接文件" class="md-nav__link">
      链接文件
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-6" type="checkbox" id="nav-6">
    
    <label class="md-nav__link" for="nav-6">
      错误总结
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="1">
      <label class="md-nav__title" for="nav-6">
        错误总结
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../ERROR/ecc_error/" title="ECC错误" class="md-nav__link">
      ECC错误
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              <div class="md-sidebar md-sidebar--secondary" data-md-component="toc">
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    
<nav class="md-nav md-nav--secondary">
  
  
  
    <label class="md-nav__title" for="__toc">目录</label>
    <ul class="md-nav__list" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#_1" title="介绍和功能总览" class="md-nav__link">
    介绍和功能总览
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#autosar" title="AutoSar架构" class="md-nav__link">
    AutoSar架构
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pdur" title="PDUR模块功能总览" class="md-nav__link">
    PDUR模块功能总览
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#i-pdu" title="I-PDU处理" class="md-nav__link">
    I-PDU处理
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#_2" title="缩略语" class="md-nav__link">
    缩略语
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#_3" title="约束和假设" class="md-nav__link">
    约束和假设
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#_4" title="限制条件" class="md-nav__link">
    限制条件
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#_5" title="已支持功能的限制条件" class="md-nav__link">
    已支持功能的限制条件
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#7" title="7 功能描述" class="md-nav__link">
    7 功能描述
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#71-i-pdu" title="7.1 I-PDU处理" class="md-nav__link">
    7.1 I-PDU处理
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#711-i-pdu" title="7.1.1 接收I-PDU给上层模块" class="md-nav__link">
    7.1.1 接收I-PDU给上层模块
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#7111" title="7.1.1.1 通信接口" class="md-nav__link">
    7.1.1.1 通信接口
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#7112" title="7.1.1.2 传输协议" class="md-nav__link">
    7.1.1.2 传输协议
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#71121-i-pdu" title="7.1.1.2.1 处理未知长度的I-PDU" class="md-nav__link">
    7.1.1.2.1 处理未知长度的I-PDU
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#712-i-pdu" title="7.1.2 从上层模块发送I-PDU" class="md-nav__link">
    7.1.2 从上层模块发送I-PDU
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#7121" title="7.1.2.1 多播" class="md-nav__link">
    7.1.2.1 多播
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#7122" title="7.1.2.2 通信接口" class="md-nav__link">
    7.1.2.2 通信接口
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#71221-trigger-transmit-data-provision" title="7.1.2.2.1 Trigger transmit data provision" class="md-nav__link">
    7.1.2.2.1 Trigger transmit data provision
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#71222" title="7.1.2.2.2 错误处理" class="md-nav__link">
    7.1.2.2.2 错误处理
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#7123" title="7.1.2.3 传输协议" class="md-nav__link">
    7.1.2.3 传输协议
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#71231" title="7.1.2.3.1 多播发送" class="md-nav__link">
    7.1.2.3.1 多播发送
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#71232" title="7.1.2.3.2 错误处理" class="md-nav__link">
    7.1.2.3.2 错误处理
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#71233-i-pdu" title="7.1.2.3.3 处理未知长度的I-PDU" class="md-nav__link">
    7.1.2.3.3 处理未知长度的I-PDU
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#713-i-pdu" title="7.1.3 I-PDU网关" class="md-nav__link">
    7.1.3 I-PDU网关
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#7131" title="7.1.3.1 通信接口模块" class="md-nav__link">
    7.1.3.1 通信接口模块
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#71311" title="7.1.3.1.1 错误处理" class="md-nav__link">
    7.1.3.1.1 错误处理
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#7132" title="7.1.3.2 传输协议" class="md-nav__link">
    7.1.3.2 传输协议
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#71321" title="7.1.3.2.1 缓冲区分配" class="md-nav__link">
    7.1.3.2.1 缓冲区分配
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#71322" title="7.1.3.2.2 直接网关" class="md-nav__link">
    7.1.3.2.2 直接网关
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#71323" title="7.1.3.2.3 转发给上层模块" class="md-nav__link">
    7.1.3.2.3 转发给上层模块
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#71324-gatewaying-on-the-fly" title="7.1.3.2.4 Gatewaying on-the-fly" class="md-nav__link">
    7.1.3.2.4 Gatewaying on-the-fly
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#71325" title="7.1.3.2.5 共同要求" class="md-nav__link">
    7.1.3.2.5 共同要求
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#71326" title="7.1.3.2.6 错误处理" class="md-nav__link">
    7.1.3.2.6 错误处理
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#71327-i-pdu" title="7.1.3.2.7 处理未知长度的I-PDU" class="md-nav__link">
    7.1.3.2.7 处理未知长度的I-PDU
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#7133-fifo" title="7.1.3.3 FIFO" class="md-nav__link">
    7.1.3.3 FIFO
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#71331" title="7.1.3.3.1 通信接口" class="md-nav__link">
    7.1.3.3.1 通信接口
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#71332" title="7.1.3.3.2 传输协议" class="md-nav__link">
    7.1.3.3.2 传输协议
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#71333" title="7.1.3.3.3 错误处理" class="md-nav__link">
    7.1.3.3.3 错误处理
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#72" title="7.2 取消发送" class="md-nav__link">
    7.2 取消发送
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#73" title="7.3 取消接收" class="md-nav__link">
    7.3 取消接收
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#74-zero-cost-operation" title="7.4 Zero Cost Operation" class="md-nav__link">
    7.4 Zero Cost Operation
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#75" title="7.5 状态管理" class="md-nav__link">
    7.5 状态管理
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#76-routing-path-groups" title="7.6 Routing path groups" class="md-nav__link">
    7.6 Routing path groups
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#77-complex-driver-interaction" title="7.7 Complex Driver Interaction" class="md-nav__link">
    7.7 Complex Driver Interaction
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
      
      
      
      
        <li class="md-nav__item">
          <a href="#__comments" title="评论" class="md-nav__link md-nav__link--active">
            评论
          </a>
        </li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          <div class="md-content">
            <article class="md-content__inner md-typeset">
              
                
                
                  <h1>PDUR</h1>
                
                <h2 id="_1">介绍和功能总览<a class="headerlink" href="#_1" title="Permanent link">&para;</a></h2>
<p>PUDR模块提供路由<code>I-PDUs</code>(<code>Interaction Layer Protocol Data Unites</code>)的服务，通过以下模块类型实现：</p>
<ul>
<li>通信接口模块：使用<code>&lt;Provider:Up&gt;</code>或<code>&lt;Provider:Lo&gt; APIs</code>，如<code>Com</code>，<code>IPduM</code>，<code>LinIf</code>，<code>CanIf</code>，<code>CanNm</code>等。</li>
<li>传输协议模块：使用<code>&lt;Provider:UpTp&gt;</code>或<code>&lt;Provider:LoTp&gt; APIs</code>，如<code>Com</code>，<code>Dcm</code>，<code>LinTp</code>，<code>CanTp</code>等。</li>
</ul>
<p><code>I-PDUs</code>的路由基于静态定义的<code>I-PDUs</code>标识符执行。没有在运行时动态的路由<code>I-PDUs</code>，如依赖<code>I-PDUs</code>的<code>payload</code>。</p>
<p>相关模块的位置可以是上层的，如<code>Com</code>，<code>IPduM</code>，<code>Dcm</code>，<code>Dlt</code>，也可以是下层的，如<code>LinIf</code>，<code>CanIf</code>，<code>LinTp</code>，<code>IPduM</code>，<code>CanNm</code>等。
注意<code>IPduM</code>既可以作为上层模块，也可以作为下层模块。</p>
<ul>
<li>下层：在<code>Com</code>和<code>IPduM</code>模块间通信。</li>
<li>上层：在<code>IPduM</code>和更底层模块间通信。</li>
</ul>
<details class="note" open="open"><summary>Note</summary><p>这里的上下层指的是<code>IPduM</code>相对于<code>PUDR</code>所处的位置。</p>
</details>
<p><code>PUDR</code>模块基于接口模块的通用方法。在<code>PUDR</code>模块配置中配置了接口模块。上一段括号中列出的模块只是示例，而不是详尽的列表。
<code>PUDR</code>可以轻松配置以支持其他上层和下层模块。这种方法还允许将复杂设备驱动程序（<code>CDD</code>）集成为<code>PUDR</code>的上层或下层模块。</p>
<p><code>PUDR</code>模块的用户列表不固定。上层和下层对的最常见组合如下所示：</p>
<ul>
<li><code>Dcm</code>和<code>Tp</code>模块；</li>
<li><code>Com</code>和<code>If</code>、<code>Tp</code>，<code>IPduM</code>模块；</li>
<li><code>IPduM</code>和<code>If</code>模块。</li>
</ul>
<h3 id="autosar"><code>AutoSar</code>架构<a class="headerlink" href="#autosar" title="Permanent link">&para;</a></h3>
<p><code>PUDR</code>模块是<code>AutoSar</code>通信结构中的中心模块，下图给出通信结构的总体描述。</p>
<p><img alt="pudr-01" src="../images/pudr-01.png" /></p>
<h3 id="pdur">PDUR模块功能总览<a class="headerlink" href="#pdur" title="Permanent link">&para;</a></h3>
<p><code>PUDR</code>模块是<code>AutoSar BSW</code>的一部分，在每个<code>AUTOSAR ECU</code>中都必须实例化。<code>PDUR</code>模块结构如下图所示：</p>
<p><img alt="pudr-02" src="../images/pudr-02.png" /></p>
<p><code>PUDR</code>模块主要有两部分组成：</p>
<ul>
<li><code>PUDR</code>路由路径：静态路由路径描述了每一个<code>I-PDUs</code>被路由的属性。The routing paths can be (if supported)
updated post-build loadable in the programming state of the ECU or selected
when initializing the PDU router by post-build selectable。</li>
<li><code>PUDR</code>引擎：根据路由路径执行路由操作的实际代码。路由器引擎必须处理：</li>
<li>将<code>I-PDUs</code>从源端路由到目的端</li>
<li>将源<code>I-PDU ID</code>转换为目标<code>I-PDU ID</code>，例如<code>PduR_ComTransmit</code> to <code>CanIf_Transmit</code>, <code>PduR_CanIfTxConfirmation</code> to <code>Com_TxConfirmation</code>。</li>
</ul>
<h3 id="i-pdu"><code>I-PDU</code>处理<a class="headerlink" href="#i-pdu" title="Permanent link">&para;</a></h3>
<p><code>I-PDU</code>由静态<code>I-PDU ID</code>标识。 <code>PDUR</code>模块通过使用静态配置表中的<code>I-PDU ID</code>来确定<code>I-PDU</code>的目的地。 <code>I-PDU</code>用于<code>PDUR</code>模块上层模块的数据交换，例如<code>Com</code>模块和<code>Dcm</code>模块。
<code>PDUR</code>模块的路由操作不会修改<code>I-PDU</code>，它只是将<code>I-PDU</code>转发到目标模块。在<code>TP</code>网关的情况下，可以在接收到完整的<code>I-PDU</code>之前开始将<code>I-PDU</code>转发到目的地。</p>
<p>在配置中设置了<code>I-PDU ID</code>并实现了<code>API</code>。这样可以有效地在每个接收<code>I-PDU ID</code>的模块中实现查找表（例如，<code>PDUR</code>模块的配置包含用于<code>PduR_CanIfTxConfirmation</code>的I-PDU ID）。</p>
<p><code>PDUR</code>模块可实现：</p>
<p>对于<code>NM</code>数据交换，PDU路由器模块被绕过。</p>
<h2 id="_2">缩略语<a class="headerlink" href="#_2" title="Permanent link">&para;</a></h2>
<hr />
<table>
<thead>
<tr>
<th align="center">缩略语</th>
<th align="center">描述</th>
</tr>
</thead>
<tbody>
<tr>
<td align="center">Upper Layer Modules(Up)</td>
<td align="center">上层模块，如<code>Com</code>，<code>Dcm</code></td>
</tr>
<tr>
<td align="center">Lower Layer Modules(Lo)</td>
<td align="center">下层模块，如<code>CAN</code>，<code>LIN</code>，<code>ETH</code>通信接口模块和传输模块</td>
</tr>
<tr>
<td align="center"><code>PDUR</code></td>
<td align="center">将<code>I-PDU</code>从一个模块传输到另一模块的模块。 <code>PDUR</code>模块可用于网关操作和内部路由目的</td>
</tr>
<tr>
<td align="center">on-the-fly gatewaying</td>
<td align="center">网关功能；在两个<code>TP</code>模块之间路由，在已接收到所有数据之前就开始了数据转发（达到指定的阈值时）。如果在两个接口之间传输大量数据，则希望能够在从源网络接收所有数据之前开始在目标网络上进行传输。这样可以节省内存和时间。</td>
</tr>
<tr>
<td align="center">多播操作</td>
<td align="center">将<code>PDU</code>同时传输到一组接收器，即<code>1：n</code>路由。</td>
</tr>
<tr>
<td align="center">data provision</td>
<td align="center">向接口模块提供数据。<strong>direct data provision</strong>: 在发送请求时直接提供要发送的数据。目标通信接口可能有两种行为，要么直接复制数据，要么将复制推迟到触发传输。<strong>trigger transmit data provision</strong>:在发送请求时未提供要发送的数据，但接口模块将通过回调函数获取要发送的数据。</td>
</tr>
<tr>
<td align="center">last-is-best buffering</td>
<td align="center">最新值覆盖最后一个值的缓冲策略。</td>
</tr>
<tr>
<td align="center">FIFO buffering</td>
<td align="center">缓冲区概念，使用先进先出策略。</td>
</tr>
<tr>
<td align="center">I-PDU ID</td>
<td align="center">PDU Identifier</td>
</tr>
<tr>
<td align="center">I-PDU</td>
<td align="center">Interaction Layer PDU. An I-PDU consists of data (buffer), length and I-PDU ID. The PDU Router will mainly route I-PDUs (exception is on-the-fly gatewaying).</td>
</tr>
<tr>
<td align="center">N-PDU</td>
<td align="center">Network Layer PDU. Used by Transport Protocol modules to fragment an I-PDU.</td>
</tr>
<tr>
<td align="center">L-PDU</td>
<td align="center">Data Link Layer PDU. One or more I-PDUs are packed into one L-PDU. The L-PDU is bus specific, e.g. CAN frame.</td>
</tr>
<tr>
<td align="center">SF</td>
<td align="center">Single Frame, Transport Protocol term</td>
</tr>
<tr>
<td align="center">FF</td>
<td align="center">First Frame, Transport Protocol term</td>
</tr>
<tr>
<td align="center">CF</td>
<td align="center">Consecutive Frame, Transport Protocol term PDU Protocol Data Unit</td>
</tr>
<tr>
<td align="center">BSW</td>
<td align="center">Basic Software</td>
</tr>
<tr>
<td align="center"><code>&lt;SrcLo&gt;</code></td>
<td align="center">Lower layer communication interface module acting as a source of the I-PDU. The SrcLo is always one.</td>
</tr>
<tr>
<td align="center"><code>&lt;DstLo&gt;</code></td>
<td align="center">Lower layer communication interface module acting as a destination of the I-PDU. The DstLo may by one to many.</td>
</tr>
<tr>
<td align="center"><code>&lt;SrcLoTp&gt;</code></td>
<td align="center">Lower layer Transport Protocol module acting as a source of the I-PDU. The SrcLoTp is always one.</td>
</tr>
<tr>
<td align="center"><code>&lt;DstLoTp&gt;</code></td>
<td align="center">Lower layer Transport Protocol module acting as a destination of the I-PDU. The DstLoTp may by one to many</td>
</tr>
<tr>
<td align="center"><code>&lt;Lo&gt;</code></td>
<td align="center">Lower layer communication interface module</td>
</tr>
<tr>
<td align="center"><code>&lt;Up&gt;</code></td>
<td align="center">Upper layer module</td>
</tr>
<tr>
<td align="center"><code>&lt;LoTp&gt;</code></td>
<td align="center">Lower layer Transport Protocol module</td>
</tr>
<tr>
<td align="center"><code>&lt;module&gt;</code></td>
<td align="center">Any type of module &lt;...&gt;</td>
</tr>
</tbody>
</table>
<h2 id="_3">约束和假设<a class="headerlink" href="#_3" title="Permanent link">&para;</a></h2>
<h3 id="_4">限制条件<a class="headerlink" href="#_4" title="Permanent link">&para;</a></h3>
<p>PDUR 模块不支持以下功能：</p>
<ul>
<li>信号提取或转换</li>
<li>数据完整性检查，如checksums</li>
<li>改变或修改 I-PDU</li>
<li>做出任何与PDU payload相关的路由决策</li>
<li>在TP模块和IF模块之间的路由，反之亦然</li>
<li>在通信接口模块之间路由I-PDU并支持速率转换，这个功能通常由上层模块支持，如COM。</li>
</ul>
<h4 id="_5">已支持功能的限制条件<a class="headerlink" href="#_5" title="Permanent link">&para;</a></h4>
<p>PDUR模块支持从本地模块（例如Com模块）传输的I-PDU的fan-out。如果将I-PDU传输到多个目的地有一些限制，(如 fan-out <span><span class="MathJax_Preview">1:n; n&gt;1</span><script type="math/tex">1:n; n>1</script></span>),因为上层模块不知道有多少个目的地。</p>
<ul>
<li>如果至少一个目标下层报告E_OK，则PDUR会报告来自上层的传输请求为E_OK。</li>
<li>PDUR从目的地低层接收到最后的传输确认时，便会向高层发送传输确认。</li>
<li>PDUR仅在所有目标较低层都返回E_OK的情况下，才返回E_OK进行上级请求的传输取消。</li>
</ul>
<p>如果I-PDU fan-out由PDUR执行，则对于作为上层模块的Com会有进一步的影响：</p>
<ul>
<li>Update bits将不在有效</li>
<li>I-PDU序列计数器将不在有效</li>
<li>通信接口API的Tx确认将如下方式处理，当最后一个目的地传输确认后，将通知本地模块（例如Com模块）。这意味着针对最后一个Tx确认进行了deadline monitoring（即，所有I-PDU是否成功传输都没有区别）。</li>
<li>I-PDU组的启动和停止会影响所有目的地</li>
</ul>
<details class="note" open="open"><summary>Note</summary><p>请注意，上述限制未设置为要求，因为它们与PduR模块提供的功能无关。但是使用PduR模块的含义将影响这些功能。</p>
</details>
<h2 id="7">7 功能描述<a class="headerlink" href="#7" title="Permanent link">&para;</a></h2>
<p>PDUR模块是一个I-PDU传输单元，位于接口模块和传输协议模块（下层模块）上方以及Com和Dcm（上层模块）下方。</p>
<p>IPDUM支持I-PDU的多路复用。当IPDUM调用PDUR模块以传输多路复用I-PDU时或当IPDUM被PDUR模块调用以接收多路复用I-PDU或发送确认或通过trigger tansmit提供数据时，作为上层模块。如果IpduM调用PDUR模块以将传输确认或接收指示转发到上层（例如Com），或者被PDUR模块调用以更新属于复用I-PDU的I-PDU，必须被视为较低层的模块。</p>
<p>从ECU的角度来看，PDUR模块可以执行三种不同类型的操作:</p>
<ul>
<li>接收PDU给本地模块：从下层模块接收I-PDU，并将它们转发到一个或多个上层模块</li>
<li>本地模块发送PDU：根据上层模块的请求将I-PDU发送到一个或多个下层模块</li>
<li>PDU网关：</li>
<li>从接口模块接收I-PDU，并通过相同或其他通信接口模块立即发送I-PDU；</li>
<li>从传输协议模块接收I-PDU，并通过相同或其他传输协议模块传输I-PDU。</li>
</ul>
<p>允许组合使用PDU接收和PDU网关。例如，Com模块接收I-PDU的同时，I-PDU将被路由到其他底层模块。</p>
<details class="note" open="open"><summary>Note</summary><p>当PduR检测到开发，运行时或瞬时错误时，在调用Default Error Tracer模块时，它将使用调用模块的模块ID作为实例ID。</p>
</details>
<h3 id="71-i-pdu">7.1 I-PDU处理<a class="headerlink" href="#71-i-pdu" title="Permanent link">&para;</a></h3>
<blockquote>
<p><strong>[SWS_PduR_00160]</strong>：PDUR模块应以一致的方式从源模块向目标模块传输未经修改的I-PDU。</p>
</blockquote>
<p>I-PDU通过I-PDU ID或符号名(I-PDU container的符号名)进行标识。对于post-build，需要I-PDU ID，因为必须在编译PDUR模块后识别I-PDU。如果PDU路由器模块是pre-compile的（即在源代码中），则可以使用符号名。</p>
<p>每个处理I-PDU并为I-PDU提供API的BSW模块都必须包含I-PDU ID列表。这意味着每个被调用模块都将具有一个标识I-PDU的查找表。</p>
<p>例如：Com模块调用 <code>PduR_ComTransmit</code>(这里PDUR模块将会列出I-PDU ID)，PDUR将会调用<code>CanIf_Transmit</code>(这里CanIf模块将会列出I-PDU ID)，CanIf模块将调用<code>PduR_CanIfTxConfirmation</code>(这里PDUR模块将会列出I-PDU ID),
PDUR模块将调用<code>Com_TxConfirmation</code>(这里Com模块将会列出I-PDU ID)，实例如下图所示，其中I-PDU ID是调用接口的参数。</p>
<p><img alt="pudr-03" src="../images/pudr-03.png" /></p>
<blockquote>
<p><strong>[SWS_PduR_00161]</strong>：PDUR模块应通过源模块I-PDU ID（位于PDU路由器配置中）和目标I-PDU ID（位于被叫目标模块配置中）的组合唯一地标识路由路径。</p>
<p><strong>[SWS_PduR_00766]</strong>：PDUR模块应将I-PDU ID转换为目的地模块的ID，以进行传输路径和确认路径。</p>
</blockquote>
<p>示例：Com模块将I-PDU传输到CanIf和LinIf。调用<code>PduR_ComTransmit</code>发送。 PDUR模块会将源I-PDU ID（PDU路由器模块配置）转换为LinIf（LinIf模块配置）的一个I-PDU ID和CanIf（CanIf模块配置）的一个I-PDU ID。
从Com模块接收到的PduInfoType值将被复制到CanIf和LinIf模块，而无需进行任何更改。</p>
<p>示例：LinIf将使用I-PDU ID调用<code>PduR_LinIfTxConfirmation</code>，并取决于传输成功与否，并返回结果E_OK（成功传输）或E_NOT_OK（传输失败）。然后，PDUR模块将转换此I-PDU ID，并使用<code>Com_TxConfirmation</code>将转换后的I-PDU ID和收到的结果转发到Com。</p>
<blockquote>
<p><strong>[SWS_PduR_00162]</strong>：PDUR模块只能根据配置中给定的路由路径来路由I-PDUs。</p>
<p><strong>[SWS_PduR_00828]</strong>：PduR生成器（验证）应拒绝通过路由路径连接具有不同MetaDataTypes的I-PDUs的配置。</p>
</blockquote>
<h4 id="711-i-pdu">7.1.1 接收I-PDU给上层模块<a class="headerlink" href="#711-i-pdu" title="Permanent link">&para;</a></h4>
<p>PDUR模块的接收操作始终由来自下层模块（通信接口模块或传输协议模块）的指示（<code>PduR_&lt;User:Lo&gt;RxIndication</code>或<code>PduR_&lt;User:LoTp&gt;RxIndication</code>）完成。指示功能由下层在通信驱动程序的周期函数的上下文中或在中断的上下文中执行。</p>
<h5 id="7111">7.1.1.1 通信接口<a class="headerlink" href="#7111" title="Permanent link">&para;</a></h5>
<p>源通信接口模块通过调用<code>PduR_&lt;User:Lo&gt;RxIndication</code>指示接收到的I-PDU。 I-PDU可能具有路由路径所配置的多个目标本地模块。</p>
<blockquote>
<p><strong>[SWS_PduR_00164]</strong>：PduR模块应通过I-PDU的1:n路由，从通信接口模块路由到一个或多个上层模块。</p>
</blockquote>
<p>例如，I-PDU从CanIf接收并转发给Com。</p>
<details class="note" open="open"><summary>Note</summary><p>I-PDU可被一个或多个上层模块同时接收，或路由到一个或多个通信接口。</p>
</details>
<blockquote>
<p><strong>[SWS_PduR_00621]</strong>：当<code>PduR_&lt;User:Lo&gt;RxIndication</code>被调用时，PDUR应调用<code>&lt;Up&gt;_RxIndication</code>，应通知每一个目标上层模块。</p>
<p><strong>[SWS_PduR_00744]</strong>：如果本地模块接收到I-PDU，PDUR模块不应检查I-PDU的长度，仅仅转发indication给上层模块。</p>
</blockquote>
<p>由于PDUR模块不会缓冲此I-PDU，因此它不必拒绝长于或短于配置的I-PDU。</p>
<p><img alt="pudr-09" src="../images/pudr-09.png" /></p>
<h5 id="7112">7.1.1.2 传输协议<a class="headerlink" href="#7112" title="Permanent link">&para;</a></h5>
<p>对于传输协议模块，当接收到首帧FF或单帧SF时，PDUR模块首先被通知开始接收提醒。通过调用<code>&lt;Up_StartOfReception&gt;</code>提醒上层模块。通过后续的<code>&lt;Lo&gt;_CopyRxData</code>调用将payload的每一个片段(NPDU)copy到目的上层模块。
接收到最后一个N-PDU后，传输协议模块会通知PDUR模块，完整的I-PDU已经被接收，PDUR模块将会通过调用<code>&lt;Up&gt;_TpRxIndication</code>转发这个通知给相关的上层模块。</p>
<p>通过传输协议模块接收I-PDU只有一个由路由路径配置的上层模块。</p>
<blockquote>
<p><strong>[SWS_PduR_00673]</strong>：PDUR模块应为从源传输协议模块接收并路由到一个目标上层模块的I-PDU提供1：1路由。</p>
</blockquote>
<p>示例：从CanTp模块接收功能寻址请求（在SF中），并将其路由到Dcm模块。</p>
<blockquote>
<p><strong>[SWS_PduR_00549]</strong>：当源传输协议模块指示仅有上层模块为目的地的PDU的开始接收时，通过<code>PduR_&lt;User:LoTp&gt;StartOfReception</code>指明，PDUR模块应当通过调用<code>&lt;Up&gt;_StartOfReception</code>，转发该请求给上层目的模块。</p>
<p><strong>[SWS_PduR_00623]</strong>：PDUR模块应当转发<code>&lt;Up&gt;_StartOfReception</code>的返回值给源传输协议模块。</p>
<p><strong>[SWS_PduR_00428]</strong>：当源传输协议模块请求PDUR模块使用<code>PduR_&lt;User:LoTp&gt;CopyRxData</code>复制接收到的数据时，PDUR模块应通过调用<code>&lt;Up&gt;_CopyRxData</code>将请求转发到目标上层模块。</p>
<p><strong>[SWS_PduR_00429]</strong>：当源传输协议模块调用<code>PduR_&lt;User-LoTp&gt;RxIndication</code>指示接收到完整的I-PDU时，PDUR模块应通过调用<code>&lt;Up&gt;_TpRxIndication</code>将指示转发到目标上层模块。</p>
<p><strong>[SWS_PduR_00207]</strong>：如果源传输协议模块使用<code>PduR_&lt;UserLoTp&gt;RxIndication</code>报告错误，则PDUR模块除将指示转发到上层模块外不应执行任何错误处理。</p>
</blockquote>
<p><img alt="pudr-10" src="../images/pudr-10.png" /></p>
<h6 id="71121-i-pdu">7.1.1.2.1 处理未知长度的I-PDU<a class="headerlink" href="#71121-i-pdu" title="Permanent link">&para;</a></h6>
<p>PduR能够使用TP API处理未知长度的I-PDU（即数据流类型）。未知长度的定义由<code>TpSduLength = 0</code>表示。</p>
<blockquote>
<p>在本地接收的场景中，<code>PduR_&lt;User:LoTp&gt;StartOfReception</code>被带<code>TpSduLength = 0</code>参数调用，PDUR应当带<code>TpSduLength = 0</code>参数调用<code>&lt;Up&gt;_StartOfReception</code>。</p>
</blockquote>
<h4 id="712-i-pdu">7.1.2 从上层模块发送I-PDU<a class="headerlink" href="#712-i-pdu" title="Permanent link">&para;</a></h4>
<p>向底层目的模块的发送操作总是异步的。这意味着当I-PDU被PDUR模块传递给底层目的模块后，发送服务请求立即返回。如果底层目的模块通过<code>PduR_&lt;User:Lo&gt;TxConfirmation</code>(通信接口)或<code>PduR_&lt;User:LoTp&gt;TxConfirmation</code>(传输协议)通知PDUR模块，传输成功或失败。
PDUR模块应当转发这个指示给上层模块通过<code>&lt;Up&gt;_TxConfirmation</code>或<code>&lt;Up&gt;_TpTxConfirmation</code>。</p>
<p>PDUR模块的发送操作由来自源上层源模块的PDU发送请求触发，并将请求转发到目标下层模块。</p>
<blockquote>
<p><strong>[SWS_PduR_00629]</strong>：如果来自源高层模块的PDU传输，则I-PDU不得在PDUR模块中进行缓冲。</p>
</blockquote>
<h5 id="7121">7.1.2.1 多播<a class="headerlink" href="#7121" title="Permanent link">&para;</a></h5>
<p>多播功能分为一个单独的部分，因为使用此功能存在一些问题，如第4.1.1节中所述。 PDUR模块直接处理的其他需求：</p>
<blockquote>
<p><strong>[SWS_PduR_00218]</strong>：如果提供的I-PDU ID代表一组PDU（多播传输请求），并且转发的传输请求中至少有一个返回成功，则功能<code>PduR_&lt;Up&gt;Transmit</code>将返回<code>E_OK</code>。</p>
</blockquote>
<p>请注意，以<code>E_OK</code>    返回的通信接口将直接(directly)或通过触发传输(trigger transmit)来传输其数据。</p>
<p>其他传输协议模块可能返回<code>E_NOT_OK</code>，因此这些模块不会调用<code>PduR_&lt;User:LoTp&gt;CopyRxData</code>。因为源上层模块已经被通知至少一个传输请求已经成功，至少一个传输协议模块将会调用<code>PduR_&lt;User:LoTp&gt;CopyRxData</code>。</p>
<blockquote>
<p><strong>[SWS_PduR_00633]</strong>：如果有多个底层目的模块的传输请求，则所有模块必须只能全为通信接口模块或传输协议模块，而不是他们的混合。</p>
</blockquote>
<p>例如：以上要求基本上意味着Com模块无法请求传输，然后PDUR模块使用相同的I-PDU将传输路由到CanTp模块和CanIf模块。</p>
<blockquote>
<p><strong>[SWS_PduR_00589]</strong>：在多播通信接口传输情况下，支持发送确认的通信接口模块收到最后一个发送确认后，PDUR模块应当调用上层模块的发送确认API。</p>
</blockquote>
<details class="note" open="open"><summary>Note</summary><p>如果并非所有目的地都提供Tx确认，则上述需求也适用。</p>
</details>
<p>当源模块请求传输并且PduR将进行多播时，请求和多播中的所有I-PDU都将具有不同的I-PDU ID。因此，PduR必须记住传输请求中的I-PDU ID，以便可以正确确认传输。</p>
<h5 id="7122">7.1.2.2 通信接口<a class="headerlink" href="#7122" title="Permanent link">&para;</a></h5>
<p>I-PDU可以通过三种方式在通信接口上传输：</p>
<ol>
<li>Direct data provision：上层模块调用<code>PduR_&lt;User:Up&gt;Transmit</code>后，PDUR模块进一步调用<code>&lt;Lo&gt;_Transmit</code>，数据被底层通信接口模块拷贝。</li>
</ol>
<p><img alt="pudr-04" src="../images/pudr-04.png" /></p>
<ol>
<li>Trigger transmit provision：当底层模块调用<code>PduR_&lt;User:Lo&gt;TriggerTransmit</code>请求传输I-PDU时，PDUR模块进一步调用<code>&lt;Up&gt;_TriggerTransmit</code>，数据被上层模块拷贝。</li>
</ol>
<p><img alt="pudr-05" src="../images/pudr-05.png" /></p>
<ol>
<li>上层模块调用<code>PduR_&lt;User:Up&gt;Transmit</code>后，PDUR模块进一步调用<code>&lt;Lo&gt;_Transmit</code>，但数据没有被底层模块拷贝，而是当底层调用<code>PduR_&lt;User:Lo&gt;TriggerTransmit</code>时请求到数据。</li>
</ol>
<p><img alt="pudr-06" src="../images/pudr-06.png" /></p>
<p>I-PDU的传输确认，对于直接和触发传输数据的规定是相同的。</p>
<blockquote>
<p><strong>[SWS_PduR_00627]</strong>：当通信接口模块调用<code>PduR_&lt;User:Lo&gt;TxConfirmation</code>后，PDUR模块应当调用上层模块的<code>&lt;Up&gt;_TxConfirmation</code>，并从下层转发传输结果给上层。
<strong>[SWS_PduR_00745]</strong>：如果I-PDU被上层模块发送，PDUR模块不应该检查I-PDU的长度。
<strong>[SWS_PduR_00625]</strong>：当源上层模块调用<code>PduR_&lt;User:Up&gt;Transmit</code>，PDUR应当调用每一路目的通信接口模块的<code>&lt;Lo&gt;_Transmit</code>。
<strong>[SWS_PduR_00626]</strong>：如果单播，<code>&lt;Lo&gt;_Transmit</code>的返回值应当转发给源上层模块。</p>
</blockquote>
<h6 id="71221-trigger-transmit-data-provision">7.1.2.2.1 Trigger transmit data provision<a class="headerlink" href="#71221-trigger-transmit-data-provision" title="Permanent link">&para;</a></h6>
<p>必须通知上层模块是否必须重置更新位并以适当的方式处理I-PDU计数器。</p>
<blockquote>
<p><strong>[SWS_PduR_00430]</strong>：PDUR模块应当转发通信接口模块的<code>PduR_&lt;User:Lo&gt;TriggerTransmit</code>请求给上层模块，通过调用<code>&lt;Up&gt;_TriggerTransmit</code>实现。
<strong>[SWS_PduR_00661]</strong>：PDUR模块应当拷贝<code>&lt;Up&gt;_TriggerTransmit</code>的返回值给下层模块。</p>
</blockquote>
<h6 id="71222">7.1.2.2.2 错误处理<a class="headerlink" href="#71222" title="Permanent link">&para;</a></h6>
<p>对于在通信接口模块上使用单播或多播发生的错误，不会进行特定的错误处理。返回值中的错误将转发到源上层模块。</p>
<h5 id="7123">7.1.2.3 传输协议<a class="headerlink" href="#7123" title="Permanent link">&para;</a></h5>
<p>使用传输协议传输I-PDU具有两种形式，即单播和多播。单播（1：1）传输由一个源上层模块和一个目标下层传输协议模块组成。多播（1：n，n&gt; 1）传输由多个目标低层传输协议模块组成。
PDU路由器模块将不会检查传输请求是否包含单个N-PDU（SF）或多个N-PDU（FF，CF，...）。</p>
<p>通过上层源模块的<code>PduR_&lt;User:Up&gt;Transmit</code>请求发起I-PDU的传输。 PduR将根据路由路径使用<code>&lt;Lo&gt;_Transmit</code>将请求转发到一个或多个目标较低层传输协议模块。请注意，<code>&lt;Lo&gt; _Transmit</code>可能包含或可能不包含数据。</p>
<p>目标模块将通过调用<code>PduR_&lt;User:LoTp&gt;CopyTxData</code>请求数据。通过<code>RetryInfoType</code>参数进行数据的重新传输（如果传输协议支持）。完成传输目标模块后调用<code>PduR_&lt;User:LoTp&gt;TxConfirmation</code>，转发到源上层模块。</p>
<blockquote>
<p><strong>[SWS_PduR_00634]</strong>：当上层模块调用<code>PduR_&lt;User:Up&gt;Transmit</code>时，PDUR模块应当调用每一路目的传输协议模块的<code>&lt;LoTp&gt;_Transmit</code>。
<strong>[SWS_PduR_00299]</strong>：当目的传输协议模块调用<code>PduR_&lt;User:LoTp&gt;CopyTxData</code>时，PDUR模块应当调用源上层模块的<code>&lt;Up&gt;_CopyTxData</code>。
<strong>[SWS_PduR_00676]</strong>：<code>&lt;Up&gt;_CopyTxData</code>的返回值应当转发给目的底层传输协议模块。
<strong>[SWS_PduR_00301]</strong>：对于单播，PUDR模块应当转发底层传输协议模块的<code>PduR_&lt;User:LoTp&gt;TxConfirmation</code>给上层模块，通过<code>&lt;Up&gt;_TpTxConfirmation</code>。
<strong>[SWS_PduR_00432]</strong>：对于单播，当调用<code>&lt;Lo&gt;_Transmit</code>后，PDUR模块应当返回相同的返回值给源上层模块调用的<code>PduR_&lt;User:Up&gt;Transmit</code>。</p>
</blockquote>
<p><img alt="pudr-07" src="../images/pudr-07.png" /></p>
<h6 id="71231">7.1.2.3.1 多播发送<a class="headerlink" href="#71231" title="Permanent link">&para;</a></h6>
<p>本小节包含使用传输协议模块对I-PDU进行多播传输的特定要求。由于在PDUR模块中进行了1：n，n&gt; 1路由，因此PDU路由器模块必须多次向源上层模块请求相同的数据。另外，必须特别处理多播的确认。</p>
<p>由于上层将多次复制同一数据，因此PDUR将使用<code>RetryInfoPtr</code>多次查询同一数据<code>RetryInfoPtr</code>包含一个称为<code>TpDataState</code>的状态类型。</p>
<blockquote>
<p><strong>[SWS_PduR_00631]</strong>：传输过程中，第一个目的底层模块的<code>PduR_&lt;User:LoTp&gt;CopyTxData</code>请求应当带参数<code>TpDataState=TP_CONFPENDING</code>转发。
<strong>[SWS_PduR_00632]</strong>：接下来的<code>PduR_&lt;User:LoTp&gt;CopyTxData</code>请求应当带参数<code>TP_DATARETRY</code>转发，为了相同的数据拷贝。
<strong>[SWS_PduR_00812]</strong>：在所有传输协议接收到它们的数据之后，PDUR模块可以向上层模块发送确认数据。
<strong>[SWS_PduR_00765]</strong>：对于多播传输，则在从下层传输协议模块接收到最后一个<code>PduR_&lt;User:LoTp&gt;TxConfirmation</code>后，PDUR模块应使用<code>&lt;Up&gt;_TpTxConfirmation</code>通知上层模块。如果至少一个<code>PduR_&lt;User:LoTp&gt;TxConfirmation</code>报告了<code>E_OK</code>，则结果参数应为<code>E_OK</code>。</p>
</blockquote>
<p><img alt="pudr-08" src="../images/pudr-08.png" /></p>
<h6 id="71232">7.1.2.3.2 错误处理<a class="headerlink" href="#71232" title="Permanent link">&para;</a></h6>
<p>PDUR模块将不会对发生的错误采取特定的措施，这些错误将转发到源上层模块。上层模块负责适当的错误处理。</p>
<h6 id="71233-i-pdu">7.1.2.3.3 处理未知长度的I-PDU<a class="headerlink" href="#71233-i-pdu" title="Permanent link">&para;</a></h6>
<p>PduR能够使用TP API处理未知长度的I-PDU（即数据流类型）。未知长度的定义由<code>TpSduLength = 0</code>表示。</p>
<blockquote>
<p><strong>[SWS_PduR_00822]</strong>：本地传输场景中，<code>PduR_&lt;User:Up&gt;Transmit</code>带参数<code>PduInfoType.SduLength=0</code>被调用，I-PDU被路由到TP模块，PDUR应当带参数<code>PduInfoType.SduLength=0</code>调用所有TP模块的<code>&lt;LoTp&gt;_Transmit</code>。</p>
</blockquote>
<h4 id="713-i-pdu">7.1.3 I-PDU网关<a class="headerlink" href="#713-i-pdu" title="Permanent link">&para;</a></h4>
<p>PDUR模块支持I-PDU从一个源总线到一个或多个目标总线的网关。与从/向本地模块进行发送和接收的区别在于，PDU路由器模块必须同时是接收器和发送器，并且在某些情况下还为I-PDU提供缓冲。</p>
<p>特意隔离网关要求，以在不需要网关的情况下有效实现PDUR模块。如果PDUR模块允许I-PDU的网关，则这些要求被视为附加要求，而不是替代以前的要求。</p>
<p>下面的列表给出网关的特征总览：</p>
<ul>
<li>I-PDU可以从源通信接口模块网关到一个（1：1）或多个目标通信接口模块（1：n I-PDU网关）<ul>
<li>对于每一个目的地，PDUR模块可通过可配置深度，缓存每一路的I-PDU(例如FIFO)</li>
<li>一个I-PDU可能在被上层模块接受的同时，被网关到n个目的通信接口模块。</li>
</ul>
</li>
<li>通过TP传输的I-PDU可能被网关到一个或多个目的TP模块。<ul>
<li>单帧或多帧可能被网关到多个目的TP模块或本地模块(如DCM)</li>
<li>多个N-PDU组成的I-PDU可能通过"on-the-fly gatewaying"的方式被网关到目的地，这意味着在开始传输之前不需要接收到完整的I-PDU。</li>
<li>多个N-PDU组成的I-PDU可能被网关到其他的TP模块或本地模块，但两者不能同时具备。</li>
<li>通过TP模块传输的I-PDU可能被FIFO缓存。这适用于单帧和多帧。</li>
</ul>
</li>
<li>I-PDU只能仅在TP模块或If模块间路由，而不能混合路由，如，通过CanIf接收到的I-PDU不能被网关到LinTp。</li>
</ul>
<p>PDUR模块应当将从一个底层模块(源网络)接收到的I-PDU转发到另一个底层模块(目标网络)，该I-PDU通过ID标识。</p>
<blockquote>
<p><strong>[SWS_PduR_00638]</strong>：I-PDU只能被网关到其他的TP模块或本地模块，但两者不能同时具备。
<strong>[SWS_PduR_00825]</strong>：
<strong>[SWS_PduR_00826]</strong>：
<strong>[SWS_PduR_00827]</strong>：
<strong>[SWS_PduR_00829]</strong>：</p>
</blockquote>
<h5 id="7131">7.1.3.1 通信接口模块<a class="headerlink" href="#7131" title="Permanent link">&para;</a></h5>
<p>I-PDU可以被一个通信接口接收并网关到n个通信接口，对于网关功能而言，可以为每一路目的通信接口配置FIFO，而不需要对本地模块进行配置。</p>
<blockquote>
<p><strong>[SWS_PduR_00436]</strong>：PDUR模块应当支持I-PDU在一个源通信接口模块和一个或多个目的通信接口模块间路由。
<strong>[SWS_PduR_00437]</strong>：PDUR模块应当支持I-PDU在两个通信接口间的立即传输(无需PDUR模块生成速率)。</p>
</blockquote>
<p>两个通信接口间的I-PDU路由不支持速率转换，这个功能可以由Com模块Signal网关实现。在这种场景下，I-PDU必须路由到Com模块。</p>
<p>取决于目的接口模块，I-PDU路由有两种方式。使用哪种方式有配置控制：</p>
<ul>
<li>
<blockquote>
<p><strong>[SWS_PduR_00303]</strong>：Direct data provision，目的I-PDU的PduRDestPduDataProvision配置为PDUR_DIRECT。当<code>&lt;DstLo&gt;_Transmit</code>被调用后，<code>&lt;DstLo&gt; module</code>执行数据拷贝，PDUR模块不会缓存发送的I-PDU。</p>
</blockquote>
</li>
<li>
<blockquote>
<p><strong>[SWS_PduR_00306]</strong>：Trigger transmit data provision，目的I-PDU的PduRDestPduDataProvision配置为PDUR_TRIGGERTRANSMIT。当<code>&lt;DstLo&gt;_Transmit</code>被调用后，<code>&lt;DstLo&gt; module</code>不执行数据拷贝，PDUR模块应当缓存发送的I-PDU，直到<code>&lt;DstLo&gt; module</code>调用<code>PduR_&lt;DstLo&gt;TriggerTransmit</code>。</p>
</blockquote>
</li>
</ul>
<blockquote>
<p><strong>[SWS_PduR_00809]</strong>：当缓存策略为last-is-best buffering，在Trigger transmit data provision时，PDUR模块缓存最后到达的I-PDU。</p>
</blockquote>
<p>Trigger transmit data provision下，I-PDU必须被缓存的原因是目的通信接口可能根据调度周期发送I-PDU，然后通信接口模块直接调用<code>PduR_&lt;DstLo&gt;TriggerTransmit</code>，而不需要前期的<code>&lt;DstLo&gt;_Transmit</code>调用。</p>
<blockquote>
<p><strong>[SWS_PduR_00662]</strong>：当使用FIFO buffer时，如果目的通信接口模块通过<code>PduR_&lt;DstLo&gt;TriggerTransmit</code>接口请求I-PDU buffer，如果FIFO是空的，则接口返回值为<code>E_NOT_OK</code>。</p>
</blockquote>
<details class="note" open="open"><summary>Note</summary><p>Note that for a gateway of an I-PDU the PduR_<Lo>TxConfirmation is not interesting (except for FIFO of a direct data provision PDU).</p>
</details>
<blockquote>
<p><strong>[SWS_PduR_00640]</strong>：If the destination communication interface module confirms the (successful or failed) transmission of the I-PDU using PduR_<DstLo>TxConfirmation and destination is not a direct data provision Pdu with FIFO buffer the PDU Router module shall not do anything.</p>
</blockquote>
<p>被网关的I-PDU可能具有不同的长度。所以：</p>
<blockquote>
<p><strong>[SWS_PduR_00783]</strong>：如果I-PDU被PDUR模块不带buffer路由，则PDUR应当按I-PDU的最小长度路由。
- 接收数据长度
- 发送目的I-PDU的数据长度</p>
<p><strong>[SWS_PduR_00746]</strong>：如果I-PDU被PDUR模块缓存，PDUR模块应当拷贝I-PDU数据的长度为以下值的最小值：
- 接收数据长度
- buffer  PduRPduMaxLength配置值。此情况下，接收I-PDU剩余部分的数据将被丢弃。</p>
</blockquote>
<p>当调用<code>PduR_&lt;DstLo&gt;TriggerTransmit</code>时，<strong>[SWS_PduR_00746]</strong>提供了避免buffer溢出的可能性。用户需要配置PduRPduMaxLength不超过目的I-PDU的长度。</p>
<blockquote>
<p><strong>[SWS_PduR_00784]</strong>：direct data provision下，当I-PDU被从PDUR buffer传输到目的模块时，PDUR应当将拷贝到buffer的字节数作为SdnLength。</p>
<p><strong>[SWS_PduR_00819]</strong>：trigger transmit data provision下，当I-PDU从PduR缓冲区复制到目标模块时，PduR应检查作为SduLength的下层缓冲区大小。如果下层缓冲区对于存储的PDU数据而言太小，则PduR将返回E_NOT_OK，并且不再处理触发发送调用。</p>
</blockquote>
<details class="note" open="open"><summary>Note</summary><p><strong>[SWS_PduR_00819]</strong>中，不处理TriggerTransmit调用，意味着PDU不得从PduR缓冲区中删除。</p>
</details>
<h6 id="71311">7.1.3.1.1 错误处理<a class="headerlink" href="#71311" title="Permanent link">&para;</a></h6>
<p>如果接口模块拒绝属于网关操作的传输请求，则PDUR模块不得对I-PDU实例执行任何错误处理。</p>
<blockquote>
<p><strong>[SWS_PduR_00256]</strong>：如果目的通信接口模块在调用<code>&lt;DstLo&gt;_Transmit</code>时返回<code>E_NOT_OK</code>后，PDUR模块不应该重试传输。</p>
</blockquote>
<p>此处目的模块出于某种原因返回<code>E_NOT_OK</code>，也会报告此错误。 PDU路由器模块除了丢弃I-PDU之外不能做其他任何事情。</p>
<h5 id="7132">7.1.3.2 传输协议<a class="headerlink" href="#7132" title="Permanent link">&para;</a></h5>
<p>将I-PDU从一个源TP模块路由到一个或多个目的TP模块有两种方式，一是完整的I-PDU发送（在发送前，接收所有N-PDU组成I-PDU)，二是，发送I-PDU片段(on-the-fly gatewaying)，在发送前，应当接收一定字节数量的I-PDU片段，该数值由PduRTpThreshold定义。</p>
<p>通常，PDUR仅对有效载荷进行网关处理，并且不会知道传输协议的详细信息，例如SF，FF，CF，PCI等。但是PduR还应支持带MetaData的I-PDU路由，并使用MetaDataType进行配置。这种I-PDU在通信接口路由或转发过程中不需要特殊处理，但是对于TP路由，附加信息必须单独发送。以下要求与直接网关和on-the-fly gatewaying相关：</p>
<blockquote>
<p><strong>[SWS_PduR_00794]</strong>：<code>PduR_&lt;SrcLoTp&gt;StartOfReception</code>接口提供I-PDU的MetaData应当被存储并提供给<code>&lt;DstLoTp&gt;_Transmit</code>。</p>
</blockquote>
<p>TP模块中，I-PDU可以被分为多个N-PDU传输(如FF和CF)，或者单帧N-PDU(SF)。一种使用场景是，由多个N-PDU组成的I-PDU不能通过多播传输(比如可以用于物理寻址)，另一种是单个N-PDU可以用于多播传输(比如功能寻址)。另一个用例是将多帧消息多播到本地接收器和多个网关目的地。</p>
<details class="note" open="open"><summary>Note</summary><p>举例，Can上接收到的单帧SF需要发送到两路LIN上，接收到SF可以携带6byte数据，但是LIN上只能携带5byte，因此，必须路由到两路LIN上时，CAN上的SF数据需要被限定为5bytes。</p>
</details>
<p>注意，通过传输协议模块传输的I-PDU也可以直接通过通信接口逐帧地被路由（即通过网关直接对N-PDU进行路由）。此处无需对PDUR模块进行特殊处理，可以通过通信接口模块进行网关处理，请参见7.1.3.1。但是，这要求源总线和目标总线具有完全相同的N-PDU打包（例如，从CAN到CAN）。</p>
<h6 id="71321">7.1.3.2.1 缓冲区分配<a class="headerlink" href="#71321" title="Permanent link">&para;</a></h6>
<h6 id="71322">7.1.3.2.2 直接网关<a class="headerlink" href="#71322" title="Permanent link">&para;</a></h6>
<h6 id="71323">7.1.3.2.3 转发给上层模块<a class="headerlink" href="#71323" title="Permanent link">&para;</a></h6>
<h6 id="71324-gatewaying-on-the-fly">7.1.3.2.4 Gatewaying on-the-fly<a class="headerlink" href="#71324-gatewaying-on-the-fly" title="Permanent link">&para;</a></h6>
<h6 id="71325">7.1.3.2.5 共同要求<a class="headerlink" href="#71325" title="Permanent link">&para;</a></h6>
<h6 id="71326">7.1.3.2.6 错误处理<a class="headerlink" href="#71326" title="Permanent link">&para;</a></h6>
<h6 id="71327-i-pdu">7.1.3.2.7 处理未知长度的I-PDU<a class="headerlink" href="#71327-i-pdu" title="Permanent link">&para;</a></h6>
<h5 id="7133-fifo">7.1.3.3 FIFO<a class="headerlink" href="#7133-fifo" title="Permanent link">&para;</a></h5>
<h6 id="71331">7.1.3.3.1 通信接口<a class="headerlink" href="#71331" title="Permanent link">&para;</a></h6>
<h6 id="71332">7.1.3.3.2 传输协议<a class="headerlink" href="#71332" title="Permanent link">&para;</a></h6>
<h6 id="71333">7.1.3.3.3 错误处理<a class="headerlink" href="#71333" title="Permanent link">&para;</a></h6>
<h3 id="72">7.2 取消发送<a class="headerlink" href="#72" title="Permanent link">&para;</a></h3>
<h3 id="73">7.3 取消接收<a class="headerlink" href="#73" title="Permanent link">&para;</a></h3>
<h3 id="74-zero-cost-operation">7.4 Zero Cost Operation<a class="headerlink" href="#74-zero-cost-operation" title="Permanent link">&para;</a></h3>
<h3 id="75">7.5 状态管理<a class="headerlink" href="#75" title="Permanent link">&para;</a></h3>
<h3 id="76-routing-path-groups">7.6 Routing path groups<a class="headerlink" href="#76-routing-path-groups" title="Permanent link">&para;</a></h3>
<h3 id="77-complex-driver-interaction">7.7 Complex Driver Interaction<a class="headerlink" href="#77-complex-driver-interaction" title="Permanent link">&para;</a></h3>
                
                  
                
              
              
                


  <h2 id="__comments">评论</h2>
  <div id="disqus_thread"></div>
  <script>
    var disqus_config = function () {
      this.page.url = "None";
      this.page.identifier =
        "None";
    };
    (function() {
      var d = document, s = d.createElement("script");
      s.src = "//OI-Wiki.disqus.com/embed.js";
      s.setAttribute("data-timestamp", +new Date());
      (d.head || d.body).appendChild(s);
    })();
  </script>

              
            </article>
          </div>
        </div>
      </main>
      
        
<footer class="md-footer">
  
    <div class="md-footer-nav">
      <nav class="md-footer-nav__inner md-grid">
        
          <a href="../.." title="Getting Started" class="md-flex md-footer-nav__link md-footer-nav__link--prev" rel="prev">
            <div class="md-flex__cell md-flex__cell--shrink">
              <i class="md-icon md-icon--arrow-back md-footer-nav__button"></i>
            </div>
            <div class="md-flex__cell md-flex__cell--stretch md-footer-nav__title">
              <span class="md-flex__ellipsis">
                <span class="md-footer-nav__direction">
                  后退
                </span>
                Getting Started
              </span>
            </div>
          </a>
        
        
          <a href="../../NVM/nvm/" title="NVM" class="md-flex md-footer-nav__link md-footer-nav__link--next" rel="next">
            <div class="md-flex__cell md-flex__cell--stretch md-footer-nav__title">
              <span class="md-flex__ellipsis">
                <span class="md-footer-nav__direction">
                  前进
                </span>
                NVM
              </span>
            </div>
            <div class="md-flex__cell md-flex__cell--shrink">
              <i class="md-icon md-icon--arrow-forward md-footer-nav__button"></i>
            </div>
          </a>
        
      </nav>
    </div>
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-footer-copyright">
        
          <div class="md-footer-copyright__highlight">
            Copyright &copy; 2016 - 2020 My Wiki
          </div>
        
        powered by
        <a href="https://www.mkdocs.org">MkDocs</a>
        and
        <a href="https://squidfunk.github.io/mkdocs-material/">
          Material for MkDocs</a>
      </div>
      
        
      
    </div>
  </div>
</footer>
      
    </div>
    
      <script src="../../assets/javascripts/application.5e60981f.js"></script>
      
        
        
          
          <script src="../../assets/javascripts/lunr/lunr.stemmer.support.js"></script>
          
            
              
                <script src="../../assets/javascripts/lunr/tinyseg.js"></script>
              
              
                <script src="../../assets/javascripts/lunr/lunr.jp.js"></script>
              
            
          
          
        
      
      <script>app.initialize({version:"1.0.4",url:{base:"../.."}})</script>
      
        <script src="../../_static/js/extra.js?v=16"></script>
      
        <script src="https://cdn.jsdelivr.net/npm/mathjax@2.7.5/MathJax.js?config=TeX-MML-AM_CHTML"></script>
      
    
    
      
        <script>!function(e,a,t,n,o,c,i){e.GoogleAnalyticsObject=o,e.ga=e.ga||function(){(e.ga.q=e.ga.q||[]).push(arguments)},e.ga.l=1*new Date,c=a.createElement(t),i=a.getElementsByTagName(t)[0],c.async=1,c.src="https://www.google-analytics.com/analytics.js",i.parentNode.insertBefore(c,i)}(window,document,"script",0,"ga"),ga("create","UA-124485594-1","auto"),ga("set","anonymizeIp",!0),ga("send","pageview");var links=document.getElementsByTagName("a");if(Array.prototype.map.call(links,function(e){e.host!=document.location.host&&e.addEventListener("click",function(){var a=e.getAttribute("data-md-action")||"follow";ga("send","event","outbound",a,e.href)})}),document.forms.search){var query=document.forms.search.query;query.addEventListener("blur",function(){if(this.value){var e=document.location.pathname;ga("send","pageview",e+"?q="+this.value)}})}</script>
      
    
  </body>
</html>